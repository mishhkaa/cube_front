"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[202],{5710:function(t,e,n){n.d(e,{j3:function(){return o}});n(2791);var i=n(814),a=n(5796),r=n(184),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.Z.confirm({title:e.title||"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438?",icon:(0,r.jsx)(a.Z,{}),content:e.content||"\u0426\u044e \u0434\u0456\u044e \u043d\u0435 \u043c\u043e\u0436\u043d\u0430 \u0441\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438.",okText:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438",okType:"danger",cancelText:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438",onOk:t})}},4685:function(t,e,n){var i=n(1413),a=n(2808),r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.Z)((0,i.Z)({url:e.startsWith("/api")?e:"/api/".concat(e),method:t},n))},o={get:function(t,e){return r("get",t,{params:e})},post:function(t,e){return r("post",t,{data:e})},put:function(t,e){return r("put",t,{data:e})},delete:function(t){return r("delete",t)},user:function(){return r("get","/api/user")},logout:function(){return r("get","/api/logout")},adminSummary:function(t){return r("get","/api/admin",{params:t})},adminRequests:function(t){return r("get","/api/admin/requests",{params:t})},adminJobs:function(t){return r("get","/api/admin/jobs",{params:t})},adminLogs:function(t){return r("get","/api/admin/logs",{params:t})},adminTrackingUsers:function(t){return r("get","/api/admin/tracking-users",{params:t})},adminRequestsByIp:function(t){return r("get","/api/admin/requests-by-ip",{params:t})},adminRequestsByCountry:function(t){return r("get","/api/admin/requests-by-country",{params:t})},lastNotices:function(){return r("get","/api/dashboard/last-notices")},users:function(t){return r("get","/api/users",{params:t})},userShow:function(t){return r("get","/api/users/".concat(t))},userStore:function(t){return r("post","/api/users",{data:t})},userUpdate:function(t,e){return r("put","/api/users/".concat(t),{data:e})},userDelete:function(t){return r("delete","/api/users/".concat(t))},usersAll:function(){return r("get","/api/users/all")},adsSources:function(t){return r("get","/api/ads-sources",{params:t})},adsSourceShow:function(t){return r("get","/api/ads-sources/".concat(t))},adsSourceStore:function(t){return r("post","/api/ads-sources",{data:t})},adsSourceUpdate:function(t,e){return r("put","/api/ads-sources/".concat(t),{data:e})},adsSourceDelete:function(t){return r("delete","/api/ads-sources/".concat(t))},integrationsFbCapi:function(t){return r("get","/api/integrations/fb-capi",{params:t})},integrationFbCapiShow:function(t){return r("get","/api/integrations/fb-capi/".concat(t))},integrationFbCapiStore:function(t){return r("post","/api/integrations/fb-capi",{data:t})},integrationFbCapiUpdate:function(t,e){return r("put","/api/integrations/fb-capi/".concat(t),{data:e})},integrationFbCapiDelete:function(t){return r("delete","/api/integrations/fb-capi/".concat(t))},integrationsTiktok:function(t){return r("get","/api/integrations/tiktok",{params:t})},integrationTiktokShow:function(t){return r("get","/api/integrations/tiktok/".concat(t))},integrationTiktokStore:function(t){return r("post","/api/integrations/tiktok",{data:t})},integrationTiktokUpdate:function(t,e){return r("put","/api/integrations/tiktok/".concat(t),{data:e})},integrationTiktokDelete:function(t){return r("delete","/api/integrations/tiktok/".concat(t))},integrationsX:function(t){return r("get","/api/integrations/x",{params:t})},integrationXShow:function(t){return r("get","/api/integrations/x/".concat(t))},integrationXStore:function(t){return r("post","/api/integrations/x",{data:t})},integrationXUpdate:function(t,e){return r("put","/api/integrations/x/".concat(t),{data:e})},integrationXDelete:function(t){return r("delete","/api/integrations/x/".concat(t))},integrationsGadsConversions:function(t){return r("get","/api/integrations/gads-conversions",{params:t})},integrationGadsConversionsShow:function(t){return r("get","/api/integrations/gads-conversions/".concat(t))},integrationGadsConversionsStore:function(t){return r("post","/api/integrations/gads-conversions",{data:t})},integrationGadsConversionsUpdate:function(t,e){return r("put","/api/integrations/gads-conversions/".concat(t),{data:e})},integrationGadsConversionsDelete:function(t){return r("delete","/api/integrations/gads-conversions/".concat(t))},integrationsGoogleSheets:function(t){return r("get","/api/integrations/google-sheets",{params:t})},integrationGoogleSheetsShow:function(t){return r("get","/api/integrations/google-sheets/".concat(t))},integrationGoogleSheetsStore:function(t){return r("post","/api/integrations/google-sheets",{data:t})},integrationGoogleSheetsUpdate:function(t,e){return r("put","/api/integrations/google-sheets/".concat(t),{data:e})},integrationGoogleSheetsDelete:function(t){return r("delete","/api/integrations/google-sheets/".concat(t))},integrationsScriptBundles:function(t){return r("get","/api/integrations/script-bundles",{params:t})},integrationScriptBundlesShow:function(t){return r("get","/api/integrations/script-bundles/".concat(t))},integrationScriptBundlesStore:function(t,e){return e?r("put","/api/integrations/script-bundles/".concat(e),{data:t}):r("post","/api/integrations/script-bundles",{data:t})},integrationScriptBundlesUpdate:function(t,e){return r("put","/api/integrations/script-bundles/".concat(t),{data:e})},integrationScriptBundlesDelete:function(t){return r("delete","/api/integrations/script-bundles/".concat(t))},integrationScriptBundlesIntegrationsAccounts:function(){return r("get","/api/integrations/script-bundles/integrations-accounts")},integrationScriptBundlesJsContent:function(){return r("get","/api/integrations/script-bundles/js-content")},integrationEventsCount:function(t){return r("get","/api/integrations/events-".concat(t))},integrationsFbAdsBalances:function(t){return r("get","/api/integrations/fb-ads-balances",{params:t})},integrationFbAdsBalancesShow:function(t){return r("get","/api/integrations/fb-ads-balances/".concat(t))},integrationFbAdsBalancesStore:function(t){return r("post","/api/integrations/fb-ads-balances",{data:t})},integrationFbAdsBalancesUpdate:function(t,e){return r("put","/api/integrations/fb-ads-balances/".concat(t),{data:e})},integrationFbAdsBalancesDelete:function(t){return r("delete","/api/integrations/fb-ads-balances/".concat(t))},integrationsCsdProjects:function(t){return r("get","/api/integrations/csd-projects",{params:t})},integrationCsdProjectsShow:function(t){return r("get","/api/integrations/csd-projects/".concat(t))},integrationCsdProjectsStore:function(t){return r("post","/api/integrations/csd-projects",{data:t})},integrationCsdProjectsUpdate:function(t,e){return r("put","/api/integrations/csd-projects/".concat(t),{data:e})},integrationCsdProjectsDelete:function(t){return r("delete","/api/integrations/csd-projects/".concat(t))},integrationEvents:function(t,e){return r("get","/api/integrations/events-".concat(t,"/").concat(e))},integrationEventsCountByEvents:function(t,e,n){return r("get","/api/integrations/events-".concat(t,"/").concat(e,"/countByEvents"),{params:n})},integrationEventsCountByDaysAndEvents:function(t,e,n){return r("get","/api/integrations/events-".concat(t,"/").concat(e,"/countByDaysAndEvents"),{params:n})},integrationEventsList:function(t,e,n){return r("get","/api/integrations/events-".concat(t,"/").concat(e,"/list"),{params:n})}};e.Z=o},7958:function(t,e,n){var i=n(4165),a=n(5861),r=n(9439),o=n(2791),s=n(7615),c=n(814),u=n(177),l=n(7145),d=n(1306),p=n(4685),g=n(184),f=[{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"UAH",value:"UAH"}];e.Z=function(t){var e=t.visible,n=t.onClose,v=t.editItem,h=t.onSuccess,m=s.Z.useForm(),Z=(0,r.Z)(m,1)[0],x=(0,o.useState)(!1),b=(0,r.Z)(x,2),j=b[0],y=b[1],S=(0,o.useState)([]),k=(0,r.Z)(S,2),C=k[0],w=k[1],F=!(null===v||void 0===v||!v.id);(0,o.useEffect)((function(){var t,n,i,a,r;e&&(p.Z.usersAll().then((function(t){return w(Array.isArray(t)?t:[])})),Z.setFieldsValue({name:null!==(t=null===v||void 0===v?void 0:v.name)&&void 0!==t?t:"",pixel_id:null!==(n=null===v||void 0===v?void 0:v.pixel_id)&&void 0!==n?n:"",access_token:null!==(i=null===v||void 0===v?void 0:v.access_token)&&void 0!==i?i:"",currency:null!==(a=null===v||void 0===v?void 0:v.currency)&&void 0!==a?a:"USD",user_id:null!==(r=null===v||void 0===v?void 0:v.user_id)&&void 0!==r?r:void 0,active:0!==(null===v||void 0===v?void 0:v.active)&&!1!==(null===v||void 0===v?void 0:v.active),testing:!(null===v||void 0===v||!v.testing)}))}),[e,v,Z]);var A=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z.validateFields();case 3:if(e=t.sent,y(!0),!F){t.next=10;break}return t.next=8,p.Z.integrationFbCapiUpdate(v.id,e);case 8:t.next=12;break;case 10:return t.next=12,p.Z.integrationFbCapiStore(e);case 12:null===h||void 0===h||h(),n(),t.next=20;break;case 16:if(t.prev=16,t.t0=t.catch(0),!t.t0.errorFields){t.next=20;break}return t.abrupt("return");case 20:return t.prev=20,y(!1),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[0,16,20,23]])})));return function(){return t.apply(this,arguments)}}(),D=C.map((function(t){return{label:t.name||t.email,value:t.id}}));return(0,g.jsx)(c.Z,{open:e,title:F?"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 Facebook CAPI":"\u0414\u043e\u0434\u0430\u0442\u0438 Facebook Conversions API",okText:F?"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438":"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438",cancelText:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438",onCancel:n,onOk:A,confirmLoading:j,destroyOnClose:!0,width:480,children:(0,g.jsxs)(s.Z,{form:Z,layout:"vertical",children:[(0,g.jsx)(s.Z.Item,{name:"name",label:"\u041d\u0430\u0437\u0432\u0430",rules:[{required:!0}],children:(0,g.jsx)(u.Z,{placeholder:"\u041d\u0430\u0437\u0432\u0430 \u043f\u0456\u043a\u0441\u0435\u043b\u044f"})}),(0,g.jsx)(s.Z.Item,{name:"pixel_id",label:"Pixel ID",rules:[{required:!0}],children:(0,g.jsx)(u.Z,{placeholder:"Facebook Pixel ID"})}),(0,g.jsx)(s.Z.Item,{name:"access_token",label:"Access Token",rules:[{required:!0}],children:(0,g.jsx)(u.Z.TextArea,{rows:3,placeholder:"\u0422\u043e\u043a\u0435\u043d \u0434\u043e\u0441\u0442\u0443\u043f\u0443"})}),(0,g.jsx)(s.Z.Item,{name:"currency",label:"\u0412\u0430\u043b\u044e\u0442\u0430",children:(0,g.jsx)(l.Z,{options:f})}),(0,g.jsx)(s.Z.Item,{name:"user_id",label:"\u041a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447",children:(0,g.jsx)(l.Z,{allowClear:!0,options:D,placeholder:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c"})}),(0,g.jsx)(s.Z.Item,{name:"active",label:"\u0410\u043a\u0442\u0438\u0432\u043d\u0438\u0439",valuePropName:"checked",children:(0,g.jsx)(d.Z,{})}),(0,g.jsx)(s.Z.Item,{name:"testing",label:"\u0422\u0435\u0441\u0442\u043e\u0432\u0438\u0439 \u0440\u0435\u0436\u0438\u043c",valuePropName:"checked",children:(0,g.jsx)(d.Z,{})})]})})}},202:function(t,e,n){n.r(e),n.d(e,{IntegrationDetail:function(){return M},default:function(){return q}});var i=n(4165),a=n(5861),r=n(9439),o=n(2791),s=n(7689),c=n(43),u=n(6473),l=n(7309),d=n(3099),p=n(7174),g=n(9372),f=n(1752),v=n(2622),h=n(4685),m=n(9305),Z=n(5710),x=n(7958),b=n(3776),j=n(1413),y=n(1717),S=n(8302),k=n(2014),C=n(7145),w=n(3640),F=n(2144),A=n(3605),D=n(3496),I=n(7892),B=n.n(I),T=n(184),E=y.Z.RangePicker,P=[{value:"",label:"\u0412\u0441\u0456 \u0441\u0442\u0430\u0442\u0443\u0441\u0438"},{value:"new",label:"\u041d\u043e\u0432\u0456"},{value:"processing",label:"\u0412\u0438\u043a\u043e\u043d\u0443\u0454\u0442\u044c\u0441\u044f"},{value:"done",label:"OK"},{value:"warning",label:"\u041f\u043e\u043f\u0435\u0440\u0435\u0434\u0436\u0435\u043d\u043d\u044f"},{value:"error",label:"\u041f\u043e\u043c\u0438\u043b\u043a\u0430"}],U=["#722ed1","#fa8c16","#eb2f96","#13c2c2","#faad14","#52c41a","#1890ff"],_=function(t){return t&&t.format?t.format("YYYY-MM-DD"):t?B()(t).format("YYYY-MM-DD"):""},G=function(t){var e=t.platform,n=t.integrationId,i=(0,o.useState)([B()().subtract(7,"day"),B()()]),a=(0,r.Z)(i,2),s=a[0],p=a[1],g=(0,o.useState)(!1),f=(0,r.Z)(g,2),v=f[0],m=f[1],Z=(0,o.useState)(""),x=(0,r.Z)(Z,2),b=x[0],y=x[1],I=(0,o.useState)([]),G=(0,r.Z)(I,2),O=G[0],Y=G[1],M=(0,o.useState)([]),q=(0,r.Z)(M,2),z=q[0],L=q[1],N=(0,o.useState)("total"),R=(0,r.Z)(N,2),X=R[0],H=R[1],J=(0,o.useState)(0),K=(0,r.Z)(J,2),V=K[0],W=K[1],Q=(0,o.useState)(!0),$=(0,r.Z)(Q,2),tt=$[0],et=$[1],nt=(0,o.useState)([]),it=(0,r.Z)(nt,2),at=it[0],rt=it[1],ot=(0,o.useState)([]),st=(0,r.Z)(ot,2),ct=st[0],ut=st[1],lt=(0,o.useState)({data:[],total:0}),dt=(0,r.Z)(lt,2),pt=dt[0],gt=dt[1],ft=(0,o.useState)(!1),vt=(0,r.Z)(ft,2),ht=vt[0],mt=vt[1],Zt=(0,o.useState)(!1),xt=(0,r.Z)(Zt,2),bt=xt[0],jt=xt[1],yt=(0,o.useState)(1),St=(0,r.Z)(yt,2),kt=St[0],Ct=St[1],wt=(0,o.useMemo)((function(){return{from:_(s[0]),to:_(s[1]),onlyFromAds:v?"1":"",events:z.length?z.join(","):O.length?O.join(","):"",status:b||void 0}}),[s,v,b,z,O]);(0,o.useEffect)((function(){e&&n?(et(!0),h.Z.integrationEvents(e,n).then((function(t){var e=Array.isArray(t)?t:[];Y(e),L((function(t){return 0===t.length?e:t}))})).catch((function(){return Y([])})).finally((function(){return et(!1)}))):et(!1)}),[e,n]);var Ft=wt.events,At=!!Ft;(0,o.useEffect)((function(){if(!e||!n||!At)return rt([]),void ut([]);mt(!0),Promise.all([h.Z.integrationEventsCountByEvents(e,n,wt),"days"===X?h.Z.integrationEventsCountByDaysAndEvents(e,n,wt):Promise.resolve([])]).then((function(t){var e=(0,r.Z)(t,2),n=e[0],i=e[1];rt(Array.isArray(n)?n:[]),ut(Array.isArray(i)?i:[])})).catch((function(){rt([]),ut([])})).finally((function(){return mt(!1)}))}),[e,n,V,At,X,wt.from,wt.to,wt.onlyFromAds,wt.events,wt.status]),(0,o.useEffect)((function(){e&&n&&At&&"list"===X&&(jt(!0),h.Z.integrationEventsList(e,n,(0,j.Z)((0,j.Z)({},wt),{},{page:kt,sort:"created_at",direction:"desc"})).then((function(t){var e,n;return gt({data:null!==(e=null===t||void 0===t?void 0:t.data)&&void 0!==e?e:[],total:null!==(n=null===t||void 0===t?void 0:t.total)&&void 0!==n?n:0})})).catch((function(){return gt({data:[],total:0})})).finally((function(){return jt(!1)})))}),[e,n,V,kt,X,At,wt.from,wt.to,wt.onlyFromAds,wt.events,wt.status]);var Dt=O.map((function(t){return{label:t,value:t}})),It=["fb","tiktok","x"].includes(e),Bt=[{name:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c",data:at.map((function(t){return t.count}))}],Tt={chart:{type:"bar",toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,distributed:!0}},colors:U,xaxis:{categories:at.map((function(t){return t.event}))},dataLabels:{enabled:!0},legend:{show:!1},yaxis:{title:{text:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c"}}},Et=ct.length?(Ft?Ft.split(","):[]).map((function(t,e){return{name:t,data:ct.map((function(e){var n;return null!==(n=e[t])&&void 0!==n?n:0}))}})).filter((function(t){return t.name})):[],Pt={chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},stroke:{curve:"smooth",width:2},xaxis:{categories:ct.map((function(t){return t.date}))},colors:U,dataLabels:{enabled:!1},legend:{position:"top"}},Ut=O.length>0;return(0,T.jsx)(u.Z,{title:"\u0412\u0456\u0434\u0441\u0442\u0435\u0436\u0435\u043d\u043d\u044f \u043f\u043e\u0434\u0456\u0439 (\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 CAPI)",className:"card-elevated",style:{marginTop:24},children:tt?(0,T.jsx)(c.Z,{tip:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u043f\u043e\u0434\u0456\u0439..."}):Ut?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(d.Z,{wrap:!0,style:{marginBottom:16},size:"middle",children:[It&&(0,T.jsx)(k.Z,{checked:v,onChange:function(t){return m(t.target.checked)},children:"\u0422\u0456\u043b\u044c\u043a\u0438 \u0437 \u0440\u0435\u043a\u043b\u0430\u0434\u0438"}),(0,T.jsxs)(d.Z,{children:[(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u0421\u0442\u0430\u0442\u0443\u0441:"}),(0,T.jsx)(C.Z,{options:P,value:b||void 0,onChange:y,style:{width:140},allowClear:!0,placeholder:"\u0412\u0441\u0456"})]}),(0,T.jsxs)(d.Z,{children:[(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041f\u043e\u0434\u0456\u0457:"}),(0,T.jsx)(C.Z,{mode:"multiple",options:Dt,value:z.length?z:O,onChange:L,style:{minWidth:200},placeholder:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u043f\u043e\u0434\u0456\u0457",maxTagCount:"responsive"})]}),(0,T.jsx)(E,{value:s,onChange:function(t){return t&&p([t[0],t[1]])},format:"YYYY-MM-DD"}),(0,T.jsx)(l.ZP,{icon:(0,T.jsx)(A.Z,{}),onClick:function(){return W((function(t){return t+1}))}})]}),(0,T.jsx)(w.Z,{activeKey:X,onChange:H,items:[{key:"total",label:"\u0417\u0432\u0435\u0434\u0435\u043d\u043d\u044f",children:null},{key:"days",label:"\u0413\u0440\u0430\u0444\u0456\u043a",children:null},{key:"list",label:"\u0421\u043f\u0438\u0441\u043e\u043a",children:null}]}),"total"===X&&(0,T.jsx)(c.Z,{spinning:ht,children:At?0===at.length?(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041d\u0435\u043c\u0430\u0454 \u0434\u0430\u043d\u0438\u0445 \u0437\u0430 \u043e\u0431\u0440\u0430\u043d\u0438\u0439 \u043f\u0435\u0440\u0456\u043e\u0434."}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(S.Z.Text,{type:"secondary",children:["\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c (",at.reduce((function(t,e){return t+e.count}),0),")"]}),(0,T.jsx)("div",{style:{marginTop:8},children:(0,T.jsx)(D.Z,{options:Tt,series:Bt,type:"bar",height:300})})]}):(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u043f\u043e\u0434\u0456\u0457 \u0442\u0430 \u0434\u0456\u0430\u043f\u0430\u0437\u043e\u043d \u0434\u0430\u0442."})}),"days"===X&&(0,T.jsx)(c.Z,{spinning:ht,children:At?0===ct.length?(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041d\u0435\u043c\u0430\u0454 \u0434\u0430\u043d\u0438\u0445 \u0437\u0430 \u043e\u0431\u0440\u0430\u043d\u0438\u0439 \u043f\u0435\u0440\u0456\u043e\u0434."}):(0,T.jsx)(D.Z,{options:Pt,series:Et,type:"line",height:300}):(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u043f\u043e\u0434\u0456\u0457 \u0442\u0430 \u0434\u0456\u0430\u043f\u0430\u0437\u043e\u043d \u0434\u0430\u0442."})}),"list"===X&&(0,T.jsx)(c.Z,{spinning:bt,children:At?(0,T.jsx)(F.Z,{rowKey:"id",size:"small",columns:[{title:"ID",dataIndex:"id",key:"id",width:80},{title:"\u041f\u043e\u0434\u0456\u044f",dataIndex:"action",key:"action",width:120},{title:"\u0421\u0442\u0430\u0442\u0443\u0441",dataIndex:"status",key:"status",width:100},{title:"\u041f\u043e\u0432\u0456\u0434\u043e\u043c\u043b\u0435\u043d\u043d\u044f",dataIndex:"message",key:"message",ellipsis:!0},{title:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",dataIndex:"created_at",key:"created_at",width:170}],dataSource:pt.data,pagination:{total:pt.total,current:kt,pageSize:35,onChange:Ct,showSizeChanger:!1}}):(0,T.jsx)(S.Z.Text,{type:"secondary",children:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c \u043f\u043e\u0434\u0456\u0457 \u0442\u0430 \u0434\u0456\u0430\u043f\u0430\u0437\u043e\u043d \u0434\u0430\u0442."})})]}):(0,T.jsx)(S.Z.Paragraph,{type:"secondary",children:"\u041f\u043e\u043a\u0438 \u043d\u0435\u043c\u0430\u0454 \u043f\u043e\u0434\u0456\u0439 \u0434\u043b\u044f \u0446\u044c\u043e\u0433\u043e \u043f\u0456\u043a\u0441\u0435\u043b\u044f. \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0437\u2019\u044f\u0432\u0438\u0442\u044c\u0441\u044f \u043f\u0456\u0441\u043b\u044f \u043d\u0430\u0434\u0441\u0438\u043b\u0430\u043d\u043d\u044f \u043f\u043e\u0434\u0456\u0439 \u0437 \u0441\u0430\u0439\u0442\u0443 (\u0437\u2019\u0454\u0434\u043d\u0430\u0439\u0442\u0435 \u0441\u043a\u0440\u0438\u043f\u0442 \u0456 \u0434\u043e\u0447\u0435\u043a\u0430\u0439\u0442\u0435\u0441\u044c \u043f\u043e\u0434\u0456\u0439)."})})},O={"fb-capi":"fb","gads-conversions":"gads",tiktok:"tiktok",x:"x"},Y={"fb-capi":{list:"integrations/fb-capi",show:function(t){return h.Z.integrationFbCapiShow(t)},delete:function(t){return h.Z.integrationFbCapiDelete(t)},FormModal:x.Z},tiktok:{list:"integrations/tiktok",show:function(t){return h.Z.integrationTiktokShow(t)},delete:function(t){return h.Z.integrationTiktokDelete(t)}},x:{list:"integrations/x",show:function(t){return h.Z.integrationXShow(t)},delete:function(t){return h.Z.integrationXDelete(t)}},"gads-conversions":{list:"integrations/gads-conversions",show:function(t){return h.Z.integrationGadsConversionsShow(t)},delete:function(t){return h.Z.integrationGadsConversionsDelete(t)}},"google-sheets":{list:"integrations/google-sheets",show:function(t){return h.Z.integrationGoogleSheetsShow(t)},delete:function(t){return h.Z.integrationGoogleSheetsDelete(t)}},"script-bundles":{list:"integrations/script-bundles",show:function(t){return h.Z.integrationScriptBundlesShow(t)},delete:function(t){return h.Z.integrationScriptBundlesDelete(t)},FormModal:b.Z},"fb-ads-balances":{list:"integrations/fb-ads-balances",show:function(t){return h.Z.integrationFbAdsBalancesShow(t)},delete:function(t){return h.Z.integrationFbAdsBalancesDelete(t)}},"fb-ads-balances-notices":{list:"integrations/fb-ads-balances",show:function(t){return h.Z.integrationFbAdsBalancesShow(t)},delete:function(t){return h.Z.integrationFbAdsBalancesDelete(t)}},"csd-projects":{list:"integrations/csd-projects",show:function(t){return h.Z.integrationCsdProjectsShow(t)},delete:function(t){return h.Z.integrationCsdProjectsDelete(t)}}},M=function(){var t=(0,s.UO)(),e=t.type,n=t.id,h=(0,s.s0)(),x=(0,o.useState)(null),b=(0,r.Z)(x,2),j=b[0],y=b[1],S=(0,o.useState)(!0),k=(0,r.Z)(S,2),C=k[0],w=k[1],F=(0,o.useState)(!1),A=(0,r.Z)(F,2),D=A[0],I=A[1],B=Y[e],E=function(){n&&null!==B&&void 0!==B&&B.show&&(w(!0),B.show(n).then(y).catch((function(){return y(null)})).finally((function(){return w(!1)})))};(0,o.useEffect)((function(){return E()}),[n,e]);var P=B?"".concat(m.sH,"/").concat(B.list):"".concat(m.sH,"/integrations"),U=null===B||void 0===B?void 0:B.FormModal;if(C)return(0,T.jsx)(c.Z,{size:"large",style:{display:"block",margin:"48px auto"}});if(!j)return(0,T.jsx)(u.Z,{title:"\u041d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e",children:(0,T.jsx)(l.ZP,{onClick:function(){return h(P)},children:"\u2190 \u041d\u0430\u0437\u0430\u0434"})});var _=Object.entries(j).filter((function(t){var e=(0,r.Z)(t,1)[0];return!["created_at","updated_at","access_token"].includes(e)})).slice(0,14);return(0,T.jsxs)("div",{children:[(0,T.jsxs)(d.Z,{style:{marginBottom:16},children:[(0,T.jsx)(l.ZP,{type:"text",icon:(0,T.jsx)(g.Z,{}),onClick:function(){return h(P)},children:"\u041d\u0430\u0437\u0430\u0434"}),U&&(0,T.jsx)(l.ZP,{type:"primary",icon:(0,T.jsx)(f.Z,{}),onClick:function(){return I(!0)},children:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438"}),(null===B||void 0===B?void 0:B.delete)&&(0,T.jsx)(l.ZP,{danger:!0,icon:(0,T.jsx)(v.Z,{}),onClick:function(){null!==B&&void 0!==B&&B.delete&&(0,Z.j3)((0,a.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.delete(n);case 2:h("".concat(m.sH,"/").concat(B.list));case 3:case"end":return t.stop()}}),t)}))),{content:'\u0417\u0430\u043f\u0438\u0441 "'.concat((null===j||void 0===j?void 0:j.name)||(null===j||void 0===j?void 0:j.id),'" \u0431\u0443\u0434\u0435 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e.')})},children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438"})]}),(0,T.jsx)(u.Z,{title:j.name||"#".concat(j.id),className:"card-elevated",children:(0,T.jsx)(p.Z,{bordered:!0,column:1,size:"small",children:_.map((function(t){var e=(0,r.Z)(t,2),n=e[0],i=e[1];return(0,T.jsx)(p.Z.Item,{label:n,children:"object"===typeof i?JSON.stringify(i):String(null!==i&&void 0!==i?i:"\u2014")},n)}))})}),U&&(0,T.jsx)(U,{visible:D,onClose:function(){return I(!1)},editItem:j,onSuccess:E}),O[e]&&(0,T.jsx)(G,{platform:O[e],integrationId:n})]})},q=M},3776:function(t,e,n){var i=n(4165),a=n(5861),r=n(9439),o=n(2791),s=n(7615),c=n(814),u=n(177),l=n(7145),d=n(1306),p=n(4685),g=n(184),f=[{value:"default",label:"\u0417\u0432\u0438\u0447\u0430\u0439\u043d\u0438\u0439"},{value:"first-last",label:"First last utms"}],v=function(t){return t?String(t).charAt(0).toUpperCase()+String(t).slice(1):""};e.Z=function(t){var e=t.visible,n=t.onClose,h=t.editItem,m=t.onSuccess,Z=s.Z.useForm(),x=(0,r.Z)(Z,1)[0],b=(0,o.useState)(!1),j=(0,r.Z)(b,2),y=j[0],S=j[1],k=(0,o.useState)(null),C=(0,r.Z)(k,2),w=C[0],F=C[1],A=!(null===h||void 0===h||!h.id);(0,o.useEffect)((function(){e&&p.Z.integrationScriptBundlesIntegrationsAccounts().then((function(t){return F(t||{})})).catch((function(){return F({})}))}),[e]),(0,o.useEffect)((function(){var t;e&&h?x.setFieldsValue({name:null!==(t=h.name)&&void 0!==t?t:"",active:!1!==h.active&&0!==h.active,utm:h.utm||void 0,integrations:h.integrations||{}}):e&&!h&&x.setFieldsValue({name:"",active:!0,utm:void 0,integrations:{}})}),[e,h,x]);var D=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(){var e,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.validateFields();case 3:return e=t.sent,a=e.integrations||{},Object.keys(a).forEach((function(t){null!=a[t]&&""!==a[t]||delete a[t]})),S(!0),t.next=9,p.Z.integrationScriptBundlesStore({name:e.name,active:e.active,utm:e.utm,integrations:a},null===h||void 0===h?void 0:h.id);case 9:null===m||void 0===m||m(),n(),t.next=17;break;case 13:if(t.prev=13,t.t0=t.catch(0),!t.t0.errorFields){t.next=17;break}return t.abrupt("return");case 17:return t.prev=17,S(!1),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[0,13,17,20]])})));return function(){return t.apply(this,arguments)}}(),I=w?Object.keys(w):[];return(0,g.jsx)(c.Z,{open:e,title:A?"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0431\u0430\u043d\u0434\u043b":"\u0414\u043e\u0434\u0430\u0442\u0438 \u0431\u0430\u043d\u0434\u043b",okText:A?"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438":"\u0414\u043e\u0434\u0430\u0442\u0438",cancelText:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438",onCancel:n,onOk:D,confirmLoading:y,destroyOnClose:!0,width:480,children:(0,g.jsxs)(s.Z,{form:x,layout:"vertical",children:[(0,g.jsx)(s.Z.Item,{name:"name",label:"\u041d\u0430\u0437\u0432\u0430",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0456\u0442\u044c \u043d\u0430\u0437\u0432\u0443"}],children:(0,g.jsx)(u.Z,{placeholder:"\u041d\u0430\u0437\u0432\u0430 \u0431\u0430\u043d\u0434\u043b\u0430"})}),I.length>0&&(0,g.jsx)(s.Z.Item,{label:"\u0406\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0456\u0457",style:{marginBottom:8},children:I.map((function(t){return(0,g.jsx)(s.Z.Item,{name:["integrations",t],label:v(t),style:{marginBottom:8},children:(0,g.jsx)(l.Z,{allowClear:!0,placeholder:"\u041e\u0431\u0435\u0440\u0456\u0442\u044c ".concat(v(t)),options:(w[t]||[]).map((function(t){return{label:"#".concat(t.id," ").concat(t.name),value:t.id}}))})},t)}))}),(0,g.jsx)(s.Z.Item,{name:"utm",label:"UTM",children:(0,g.jsx)(l.Z,{allowClear:!0,options:f,placeholder:"\u0417\u0432\u0438\u0447\u0430\u0439\u043d\u0438\u0439"})}),(0,g.jsx)(s.Z.Item,{name:"active",label:"\u0423\u0432\u0456\u043c\u043a\u043d\u0435\u043d\u043e",valuePropName:"checked",children:(0,g.jsx)(d.Z,{})})]})})}}}]);
//# sourceMappingURL=202.796b0578.chunk.js.map